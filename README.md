# ГОЛОСОВОЙ ПОМОЩНИК МАШИНИСТА
Голосовой помощник помогает машинистам принимать своевременные и правильные решения для устранения, выявления и предупреждения проблем с локомотивным составом. 
На основе огромной базы данных возможных вопросов и ответов, а также, при помощи технологии ***NLP и распознавания голоса*** машиниста, производится поиск соответствующего ответа, после чего озвучивается, используя стандартное кроссплатформенное решение ***text-to-speech***.

**Использование приложения производится в Telegram и Desktop версиях.**
***Тестирование происходило на Python 3.10 и 3.8, ОС - Windows***


## Структура проекта и полезные ссылки
__Программые модули состоят из:__
1. Модуль распознавания голоса на базе Vosk с дообучением на технических словах через библиотеку Kaldi ASR.
   - **Vosk**: https://alphacephei.com/vosk/
   - **Kaldi ASR**: https://kaldi-asr.org/
   - Датасеты для дообучения:
     - Словарь новых аббревиатур ```map_1.json```
     - Словарь технических слов и железнодорожного жаргона ```terms.txt```
3. Модуль вопросно-ответной системы, состоящий из предобученной модели **LLaMa**
   - Датасет: ```railways/data.json```
5. Модуль преобразования текста в речь **pyttsx3** – https://github.com/nateshmbhat/pyttsx3
6. Модуль UI/UX
   - TelegramBot – https://t.me/train_driver_smart_assistant_bot (@train_driver_smart_assistant_bot)
   - PyQt5

## Установка и запуск
Ввод и вывод ответов и вопросов осуществляется через голосовые сообщения (Telegram) и встроенные функции микрофона (Desktop).

***Перед пользованием программной реализацией необходимо установить зависимости и подключить языковую модель LLaMa:***
   - Зависимости: ```pip install -r requirements.txt``` или запустить ```install_deps.bat```
   - Установить Microsoft C++ Build Tools https://visualstudio.microsoft.com/ru/visual-cpp-build-tools/
   - LLaMa: ```railways/run_all_servers.bat```
### Desktop-версия
Автономная версия, использующая вычислительные ресурсы пользователя.

Запустить оконное приложение: ```app/open_desktop.bat```

- Вся история сообщений пользователя сохраняется в виде прокручивающейся панели мессенджера с блоками вопросов ответов и ответов системы.

- Для совершения голосовых запросов, необходимо нажать на кнопку микрофона, после чего начнется запись аудиозапроса.
  
  ![image](./audio/МикрофонВыкл.png)
  
   После завершения вопроса снова нажать на кнопку микрофона для начала обработки запроса.

  ![image](./audio/МикрофонВкл.png)
  
___Максимальное время одной записи по умолчанию - 30 секунд.___

- Изменить номер поезда можно через выпадающий список в верхней правой части окна.

  ![image](./audio/ВыборПоезда.png)

- Переключение между генеративным (общением) и шаблонным (по базе данных ответов) ответом системы осуществляется через переключатель в перхней левой части окна.

  ![image](./audio/ГенерацияОтвета.png)


### Telegram-версия
Мобильная версия приложения, можно использовать как офлайн (локальная сеть), так и онлайн (удаленный хост)

Запустить Telegram-бота: ```app/open_desktop.bat```

Использовать бота можно по ссылке https://t.me/train_driver_smart_assistant_bot или по никнейму бота ```@train_driver_smart_assistant_bot```
При первом использовании необходимо выбрать номер поезда. Актуальный список поездов доступен по кнопке ```Список поездов```.


___Внимание: При обновлении поезда сбрасывается контекст предыдущих сообщений с ботом (сбросится связь предыдудщих и новых запросов)___
